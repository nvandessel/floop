{"id":"behavior-221fe596f8d6","kind":"behavior","content":{"content":{"canonical":"Use fmt.Fprintln(os.Stderr, err) for error output","expanded":"When working on this type of task, avoid: Used fmt.Println for errors\n\nInstead: Use fmt.Fprintln(os.Stderr, err) for error output","structured":{"avoid":"Used fmt.Println for errors","prefer":"Use fmt.Fprintln(os.Stderr, err) for error output"}},"kind":"preference","name":"learned/use-fmt-fprintlnos-stderr-err-for-error-output","provenance":{"correction_id":"correction-1769667125","created_at":"2026-01-28T22:12:05.02673759-08:00","source_type":"learned"},"when":{"file_path":"tmp/*","language":"go"}},"metadata":{"confidence":0.5499999999999999,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-8341f0d52ce6","kind":"behavior","content":{"content":{"canonical":"MCP go-sdk expects jsonschema:\"Description text\" format without key=value syntax. The tag value is directly the description.","expanded":"When working on this type of task, avoid: Subagent used jsonschema:\"description=...\" tag format which caused MCP SDK panic\n\nInstead: MCP go-sdk expects jsonschema:\"Description text\" format without key=value syntax. The tag value is directly the description.","structured":{"avoid":"Subagent used jsonschema:\"description=...\" tag format which caused MCP SDK panic","prefer":"MCP go-sdk expects jsonschema:\"Description text\" format without key=value syntax. The tag value is directly the description."}},"kind":"directive","name":"learned/mcp-go-sdk-expects-jsonschemadescription-text-f","provenance":{"correction_id":"correction-1769817031","created_at":"2026-01-30T15:50:31.088121234-08:00","source_type":"learned"},"when":{"file_path":"mcp/*","language":"go"}},"metadata":{"confidence":0.66,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-dfdc5e16b9e0","kind":"behavior","content":{"content":{"canonical":"Consider both global (~/.floop/) and local (./.floop/) scopes - users want personal preferences across ALL projects AND project-specific conventions","expanded":"When working on this type of task, avoid: Only considered project-local behavior storage\n\nInstead: Consider both global (~/.floop/) and local (./.floop/) scopes - users want personal preferences across ALL projects AND project-specific conventions","structured":{"avoid":"Only considered project-local behavior storage","prefer":"Consider both global (~/.floop/) and local (./.floop/) scopes - users want personal preferences across ALL projects AND project-specific conventions"}},"kind":"preference","name":"learned/consider-both-global-~-floop-and-local-flo","provenance":{"correction_id":"c-1769577654747582237","created_at":"2026-01-27T21:20:54.748483819-08:00","source_type":"learned"},"when":{"file_path":"store/*","language":"go"}},"metadata":{"confidence":0.66,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-c0df6c4cb954","kind":"behavior","content":{"content":{"canonical":"When force-graph nodes disappear on interaction, check for dangling edges FIRST — edges where source or target doesn't exist in the nodes array. These cause TypeError crashes in d3-force on simulation reheat. Always filter edges before passing to force-graph: validEdges = edges.filter(e =\u003e nodeIds[e.source] \u0026\u0026 nodeIds[e.target]). Also need autoPauseRedraw(false) for shadow canvas hit detection and safe force parameters (charge max -400, velocityDecay \u003e= 0.4).","expanded":"When working on this type of task, avoid: When debugging force-graph drag issues, focused on autoPauseRedraw and force parameters without checking for dangling edges (edges referencing non-existent nodes). The real crash was a TypeError from d3-force trying to set vx on a string ID when the simulation reheated during drag.\n\nInstead: When force-graph nodes disappear on interaction, check for dangling edges FIRST — edges where source or target doesn't exist in the nodes array. These cause TypeError crashes in d3-force on simulation reheat. Always filter edges before passing to force-graph: validEdges = edges.filter(e =\u003e nodeIds[e.source] \u0026\u0026 nodeIds[e.target]). Also need autoPauseRedraw(false) for shadow canvas hit detection and safe force parameters (charge max -400, velocityDecay \u003e= 0.4).","structured":{"avoid":"When debugging force-graph drag issues, focused on autoPauseRedraw and force parameters without checking for dangling edges (edges referencing non-existent nodes). The real crash was a TypeError from d3-force trying to set vx on a string ID when the simulation reheated during drag.","prefer":"When force-graph nodes disappear on interaction, check for dangling edges FIRST — edges where source or target doesn't exist in the nodes array. These cause TypeError crashes in d3-force on simulation reheat. Always filter edges before passing to force-graph: validEdges = edges.filter(e =\u003e nodeIds[e.source] \u0026\u0026 nodeIds[e.target]). Also need autoPauseRedraw(false) for shadow canvas hit detection and safe force parameters (charge max -400, velocityDecay \u003e= 0.4)."}},"kind":"procedure","name":"learned/when-force-graph-nodes-disappear-on-interaction-c","provenance":{"correction_id":"c-1771189281277951516","created_at":"2026-02-15T13:01:21.279752047-08:00","source_type":"learned"},"when":{"file_path":"visualization/*","task":"development"}},"metadata":{"confidence":0.6,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-d9c85c37d639","kind":"behavior","content":{"content":{"canonical":"Never set cooldownTicks to a finite value on force-graph — use cooldownTime(Infinity) and let the simulation cool down naturally via d3AlphaDecay. Also add onNodeDragEnd to release pinned nodes (fx/fy = undefined) so they rejoin the simulation after being dragged.","expanded":"When working on this type of task, avoid: Set cooldownTicks(500) on force-graph, which permanently kills the d3 simulation after 500 ticks. The internal tick counter never resets on drag — only on graphData() calls. This causes all drag interactions (node and canvas) to break after the initial simulation settles.\n\nInstead: Never set cooldownTicks to a finite value on force-graph — use cooldownTime(Infinity) and let the simulation cool down naturally via d3AlphaDecay. Also add onNodeDragEnd to release pinned nodes (fx/fy = undefined) so they rejoin the simulation after being dragged.","structured":{"avoid":"Set cooldownTicks(500) on force-graph, which permanently kills the d3 simulation after 500 ticks. The internal tick counter never resets on drag — only on graphData() calls. This causes all drag interactions (node and canvas) to break after the initial simulation settles.","prefer":"Never set cooldownTicks to a finite value on force-graph — use cooldownTime(Infinity) and let the simulation cool down naturally via d3AlphaDecay. Also add onNodeDragEnd to release pinned nodes (fx/fy = undefined) so they rejoin the simulation after being dragged."}},"kind":"constraint","name":"learned/never-set-cooldownticks-to-a-finite-value-on-force","provenance":{"correction_id":"c-1770879519409346793","created_at":"2026-02-11T22:58:39.409524386-08:00","source_type":"learned"},"when":{"file_path":"visualization/*","task":"development"}},"metadata":{"confidence":0.6,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-dbef97df332b","kind":"behavior","content":{"content":{"canonical":"Use template.JS for values injected into script blocks. Pre-sanitize with json.HTMLEscape to prevent script breakout XSS. template.HTML is only trusted for HTML contexts, not JS contexts in html/template.","expanded":"When working on this type of task, avoid: Used template.HTML for injecting JSON into a script block in html/template. html/template applies JS-encoding on template.HTML values inside script contexts, turning JSON objects into quoted strings.\n\nInstead: Use template.JS for values injected into script blocks. Pre-sanitize with json.HTMLEscape to prevent script breakout XSS. template.HTML is only trusted for HTML contexts, not JS contexts in html/template.","structured":{"avoid":"Used template.HTML for injecting JSON into a script block in html/template. html/template applies JS-encoding on template.HTML values inside script contexts, turning JSON objects into quoted strings.","prefer":"Use template.JS for values injected into script blocks. Pre-sanitize with json.HTMLEscape to prevent script breakout XSS. template.HTML is only trusted for HTML contexts, not JS contexts in html/template."},"tags":["javascript","json","security"]},"kind":"preference","name":"learned/use-template-js-for-values-injected-into-script-bl","provenance":{"correction_id":"c-1770862232174665584","source_type":"learned"},"when":{"file_path":"visualization/*","language":"go","task":"development"}},"metadata":{"confidence":0.625,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","last_activated":"2026-02-11T19:38:40-08:00","times_activated":2,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-4b6eb2564f4f","kind":"behavior","content":{"content":{"canonical":"@clerk/testing's clerkSetup() only checks: NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, VITE_CLERK_PUBLISHABLE_KEY, CLERK_PUBLISHABLE_KEY, REACT_APP_CLERK_PUBLISHABLE_KEY, EXPO_PUBLIC_CLERK_PUBLISHABLE_KEY. For Astro (PUBLIC_CLERK_PUBLISHABLE_KEY), you must ALSO set CLERK_PUBLISHABLE_KEY in .env. For sign-in, use clerk.signIn({ page, emailAddress }) instead of password strategy — it uses CLERK_SECRET_KEY backend API, no password needed, avoids breach-list rejections.","expanded":"When working on this type of task, avoid: Tried to use password strategy with clerk.signIn() for Playwright auth setup. Also assumed @clerk/testing would recognize Astro's PUBLIC_CLERK_PUBLISHABLE_KEY env var.\n\nInstead: @clerk/testing's clerkSetup() only checks: NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, VITE_CLERK_PUBLISHABLE_KEY, CLERK_PUBLISHABLE_KEY, REACT_APP_CLERK_PUBLISHABLE_KEY, EXPO_PUBLIC_CLERK_PUBLISHABLE_KEY. For Astro (PUBLIC_CLERK_PUBLISHABLE_KEY), you must ALSO set CLERK_PUBLISHABLE_KEY in .env. For sign-in, use clerk.signIn({ page, emailAddress }) instead of password strategy — it uses CLERK_SECRET_KEY backend API, no password needed, avoids breach-list rejections.","structured":{"avoid":"Tried to use password strategy with clerk.signIn() for Playwright auth setup. Also assumed @clerk/testing would recognize Astro's PUBLIC_CLERK_PUBLISHABLE_KEY env var.","prefer":"@clerk/testing's clerkSetup() only checks: NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, VITE_CLERK_PUBLISHABLE_KEY, CLERK_PUBLISHABLE_KEY, REACT_APP_CLERK_PUBLISHABLE_KEY, EXPO_PUBLIC_CLERK_PUBLISHABLE_KEY. For Astro (PUBLIC_CLERK_PUBLISHABLE_KEY), you must ALSO set CLERK_PUBLISHABLE_KEY in .env. For sign-in, use clerk.signIn({ page, emailAddress }) instead of password strategy — it uses CLERK_SECRET_KEY backend API, no password needed, avoids breach-list rejections."},"tags":["api","configuration","testing"]},"kind":"constraint","name":"learned/clerk-testings-clerksetup-only-checks-next_pu","provenance":{"correction_id":"c-1771185582703626140","created_at":"2026-02-15T11:59:42.703834-08:00","source_type":"learned"},"when":{"file_path":"tests/*","language":"typescript","task":"testing"}},"metadata":{"confidence":0.6,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-9d180407fda6","kind":"behavior","content":{"content":{"canonical":"Content hash collision during INSERT should either error explicitly or trigger proper deduplication flow. The current silent replace behavior can cause data loss. Consider: (1) remove UNIQUE constraint and handle dedup separately, or (2) check for existing content_hash before insert and return meaningful error.","expanded":"When working on this type of task, avoid: SQLite store uses INSERT OR REPLACE with a UNIQUE content_hash constraint. When two behaviors have identical canonical content, the second silently replaces the first instead of erroring or deduplicating properly.\n\nInstead: Content hash collision during INSERT should either error explicitly or trigger proper deduplication flow. The current silent replace behavior can cause data loss. Consider: (1) remove UNIQUE constraint and handle dedup separately, or (2) check for existing content_hash before insert and return meaningful error.","structured":{"avoid":"SQLite store uses INSERT OR REPLACE with a UNIQUE content_hash constraint. When two behaviors have identical canonical content, the second silently replaces the first instead of erroring or deduplicating properly.","prefer":"Content hash collision during INSERT should either error explicitly or trigger proper deduplication flow. The current silent replace behavior can cause data loss. Consider: (1) remove UNIQUE constraint and handle dedup separately, or (2) check for existing content_hash before insert and return meaningful error."}},"kind":"preference","name":"learned/content-hash-collision-during-insert-should-either","provenance":{"correction_id":"c-1770270981283723438","created_at":"2026-02-04T21:56:21.283777669-08:00","source_type":"learned"},"when":{"file_path":"store/*","language":"go","task":"bug-identification"}},"metadata":{"confidence":0.66,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","times_activated":0,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
{"id":"behavior-c83aad31d913","kind":"behavior","content":{"content":{"canonical":"Use template.JS (not template.HTML) for data injected into  blocks in html/template. template.HTML only asserts HTML safety — in JS contexts the engine still JS-escapes it. template.JS asserts JS safety and prevents double-encoding. Combine with json.HTMLEscape for XSS prevention (converts \u003c \u003e \u0026 to unicode escapes, preventing  breakout)","expanded":"When working on this type of task, avoid: Used template.HTML for JSON data inside an html/template  block, which caused the template engine to JS-escape the value (wrapping in quotes and escaping inner quotes), turning the JSON object into a string literal\n\nInstead: Use template.JS (not template.HTML) for data injected into  blocks in html/template. template.HTML only asserts HTML safety — in JS contexts the engine still JS-escapes it. template.JS asserts JS safety and prevents double-encoding. Combine with json.HTMLEscape for XSS prevention (converts \u003c \u003e \u0026 to unicode escapes, preventing  breakout)","structured":{"avoid":"Used template.HTML for JSON data inside an html/template  block, which caused the template engine to JS-escape the value (wrapping in quotes and escaping inner quotes), turning the JSON object into a string literal","prefer":"Use template.JS (not template.HTML) for data injected into  blocks in html/template. template.HTML only asserts HTML safety — in JS contexts the engine still JS-escapes it. template.JS asserts JS safety and prevents double-encoding. Combine with json.HTMLEscape for XSS prevention (converts \u003c \u003e \u0026 to unicode escapes, preventing  breakout)"},"tags":["javascript","json","security"]},"kind":"preference","name":"learned/use-template-js-not-template-html-for-data-injec","provenance":{"correction_id":"c-1770862037019587237","source_type":"learned"},"when":{"file_path":"visualization/*","language":"go","task":"development"}},"metadata":{"confidence":0.625,"priority":0,"scope":"local","stats":{"created_at":"2026-02-17T08:52:00-08:00","last_activated":"2026-02-11T19:38:40-08:00","times_activated":2,"times_confirmed":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-02-17T08:52:00-08:00"}}}
