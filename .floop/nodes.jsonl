{"id":"behavior-81e201973717","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Create a dedicated usage guide (docs/FLOOP_USAGE.md) and reference it prominently in AGENTS.md - separates 'what' from 'how' and makes instructions comprehensive","expanded":"When working on this type of task, avoid: Created inline usage instructions in AGENTS.md\n\nInstead: Create a dedicated usage guide (docs/FLOOP_USAGE.md) and reference it prominently in AGENTS.md - separates 'what' from 'how' and makes instructions comprehensive","structured":{"avoid":"Created inline usage instructions in AGENTS.md","prefer":"Create a dedicated usage guide (docs/FLOOP_USAGE.md) and reference it prominently in AGENTS.md - separates 'what' from 'how' and makes instructions comprehensive"}},"kind":"directive","name":"learned/create-a-dedicated-usage-guide-docs-floop_usage-m","overrides":null,"provenance":{"correction_id":"c-1769578257801753560","created_at":"2026-01-27T21:30:57.802170973-08:00","source_type":"learned"},"requires":null,"when":{"language":"markdown"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T21:30:57.802183818-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T21:30:57.802183878-08:00"}}}
{"id":"behavior-5d3f7201e10d","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"When fixing bugs: (1) identify the bug, (2) write a test that fails due to that bug, (3) implement the fix, (4) verify the test passes. This builds confidence in the test suite as it expands.","expanded":"When working on this type of task, avoid: Identified a bug, then immediately implemented the fix without writing a failing test first\n\nInstead: When fixing bugs: (1) identify the bug, (2) write a test that fails due to that bug, (3) implement the fix, (4) verify the test passes. This builds confidence in the test suite as it expands.","structured":{"avoid":"Identified a bug, then immediately implemented the fix without writing a failing test first","prefer":"When fixing bugs: (1) identify the bug, (2) write a test that fails due to that bug, (3) implement the fix, (4) verify the test passes. This builds confidence in the test suite as it expands."}},"kind":"directive","name":"learned/when-fixing-bugs-1-identify-the-bug-2-write","overrides":null,"provenance":{"correction_id":"correction-1769740357","created_at":"2026-01-29T18:32:37.391333747-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-29T18:32:37.391368453-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-29T18:32:37.391368603-08:00"}}}
{"id":"behavior-1a35b59d9b4d","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"When using subagents with git worktrees, either: (1) create worktrees inside the repo (e.g., .worktrees/feature-name) so subagents can access them, or (2) have the orchestrating agent do parallel work directly in main and manage branches/commits itself, then cherry-pick to a single consolidated branch.","expanded":"When working on this type of task, avoid: Created git worktrees as sibling directories (../floop-*) and spawned subagents to work in them. Subagents couldn't access worktree paths due to sandbox restrictions that block access outside the main repo directory.\n\nInstead: When using subagents with git worktrees, either: (1) create worktrees inside the repo (e.g., .worktrees/feature-name) so subagents can access them, or (2) have the orchestrating agent do parallel work directly in main and manage branches/commits itself, then cherry-pick to a single consolidated branch.","structured":{"avoid":"Created git worktrees as sibling directories (../floop-*) and spawned subagents to work in them. Subagents couldn't access worktree paths due to sandbox restrictions that block access outside the main repo directory.","prefer":"When using subagents with git worktrees, either: (1) create worktrees inside the repo (e.g., .worktrees/feature-name) so subagents can access them, or (2) have the orchestrating agent do parallel work directly in main and manage branches/commits itself, then cherry-pick to a single consolidated branch."}},"kind":"procedure","name":"learned/when-using-subagents-with-git-worktrees-either","overrides":null,"provenance":{"correction_id":"correction-1769746693","created_at":"2026-01-29T20:18:13.769565291-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-29T20:18:13.769584658-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-29T20:18:13.769584738-08:00"}}}
{"id":"behavior-e98a675ef270","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Background subagents do NOT inherit parent permissions - they require pre-approved permissions via ~/.claude/settings.json. Add \"Write:*\", \"Edit:*\", \"Task:*\" to permissions.allow array. This enables parallel worktree development with background agents.","expanded":"When working on this type of task, avoid: Assumed subagents inherit parent agent permissions automatically. When background subagents failed with \"Permission auto-denied (prompts unavailable)\", investigated complex solutions like passing allowedPrompts to Task tool.\n\nInstead: Background subagents do NOT inherit parent permissions - they require pre-approved permissions via ~/.claude/settings.json. Add \"Write:*\", \"Edit:*\", \"Task:*\" to permissions.allow array. This enables parallel worktree development with background agents.","structured":{"avoid":"Assumed subagents inherit parent agent permissions automatically. When background subagents failed with \"Permission auto-denied (prompts unavailable)\", investigated complex solutions like passing allowedPrompts to Task tool.","prefer":"Background subagents do NOT inherit parent permissions - they require pre-approved permissions via ~/.claude/settings.json. Add \"Write:*\", \"Edit:*\", \"Task:*\" to permissions.allow array. This enables parallel worktree development with background agents."}},"kind":"constraint","name":"learned/background-subagents-do-not-inherit-parent-permiss","overrides":null,"provenance":{"source_type":"learned","created_at":"2026-01-30T09:25:01.346312529-08:00","correction_id":"correction-1769793901"},"requires":null,"when":{"file_path":"~/*","language":"json"}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"times_activated":0,"times_followed":0,"times_overridden":0,"created_at":"2026-01-30T09:25:01.346352983-08:00","updated_at":"2026-01-30T09:25:01.346353114-08:00"}}}
{"id":"behavior-fe7c50122f69","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"When subagents fail with \"Permission auto-denied (prompts unavailable)\", the issue is that background agents cannot request interactive permissions. The fix is to ensure subagents are granted necessary permissions upfront when spawned, OR to run them in foreground mode where they can request permissions. Investigate how to pass allowedPrompts or similar when spawning Task agents.","expanded":"When working on this type of task, avoid: Logged a learning that says orchestrating agent should do all writes when subagents fail due to permissions - this defeats the purpose of parallel subagent work\n\nInstead: When subagents fail with \"Permission auto-denied (prompts unavailable)\", the issue is that background agents cannot request interactive permissions. The fix is to ensure subagents are granted necessary permissions upfront when spawned, OR to run them in foreground mode where they can request permissions. Investigate how to pass allowedPrompts or similar when spawning Task agents.","structured":{"avoid":"Logged a learning that says orchestrating agent should do all writes when subagents fail due to permissions - this defeats the purpose of parallel subagent work","prefer":"When subagents fail with \"Permission auto-denied (prompts unavailable)\", the issue is that background agents cannot request interactive permissions. The fix is to ensure subagents are granted necessary permissions upfront when spawned, OR to run them in foreground mode where they can request permissions. Investigate how to pass allowedPrompts or similar when spawning Task agents."}},"kind":"directive","name":"learned/when-subagents-fail-with-permission-auto-denied","overrides":null,"provenance":{"correction_id":"correction-1769790706","created_at":"2026-01-30T08:31:46.041648422-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-30T08:31:46.041701825-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-30T08:31:46.041701975-08:00"}}}
{"id":"behavior-a9a4b09dda1f","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Create explicit hooks in AGENTS.md that mandate tool usage - use WARNING/CRITICAL markers and 'READ FIRST' to ensure visibility","expanded":"When working on this type of task, avoid: Assumed agents would know when to use tools based on general context\n\nInstead: Create explicit hooks in AGENTS.md that mandate tool usage - use WARNING/CRITICAL markers and 'READ FIRST' to ensure visibility","structured":{"avoid":"Assumed agents would know when to use tools based on general context","prefer":"Create explicit hooks in AGENTS.md that mandate tool usage - use WARNING/CRITICAL markers and 'READ FIRST' to ensure visibility"}},"kind":"procedure","name":"learned/create-explicit-hooks-in-agents-md-that-mandate-to","overrides":null,"provenance":{"correction_id":"c-1769578263708845277","created_at":"2026-01-27T21:31:03.709247071-08:00","source_type":"learned"},"requires":null,"when":{"task":"documentation"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T21:31:03.709259124-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T21:31:03.709259174-08:00"}}}
{"id":"behavior-7a098cb05216","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Always create detailed beads (epic + tasks) with dependency graphs after planning - enables easy handoff between agents and sessions","expanded":"When working on this type of task, avoid: Jumped directly into implementation after planning without creating beads structure\n\nInstead: Always create detailed beads (epic + tasks) with dependency graphs after planning - enables easy handoff between agents and sessions","structured":{"avoid":"Jumped directly into implementation after planning without creating beads structure","prefer":"Always create detailed beads (epic + tasks) with dependency graphs after planning - enables easy handoff between agents and sessions"}},"kind":"directive","name":"learned/always-create-detailed-beads-epic-+-tasks-with-d","overrides":null,"provenance":{"correction_id":"c-1769580766063884670","created_at":"2026-01-27T22:12:46.064288178-08:00","source_type":"learned"},"requires":null,"when":{"task":"project-management"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T22:12:46.064300681-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T22:12:46.064300731-08:00"}}}
{"id":"behavior-84a379605b43","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Create git worktrees in .worktrees/ directory at repo root (e.g., 'git worktree add .worktrees/feature-name -b branch-name'). This directory is in .gitignore so it won't pollute git status, and subagents can access it since it's inside the repo.","expanded":"When working on this type of task, avoid: Created git worktrees as sibling directories (../floop-*) which subagents couldn't access due to sandbox restrictions.\n\nInstead: Create git worktrees in .worktrees/ directory at repo root (e.g., 'git worktree add .worktrees/feature-name -b branch-name'). This directory is in .gitignore so it won't pollute git status, and subagents can access it since it's inside the repo.","structured":{"avoid":"Created git worktrees as sibling directories (../floop-*) which subagents couldn't access due to sandbox restrictions.","prefer":"Create git worktrees in .worktrees/ directory at repo root (e.g., 'git worktree add .worktrees/feature-name -b branch-name'). This directory is in .gitignore so it won't pollute git status, and subagents can access it since it's inside the repo."}},"kind":"directive","name":"learned/create-git-worktrees-in-worktrees-directory-at-r","overrides":null,"provenance":{"correction_id":"correction-1769746975","created_at":"2026-01-29T20:22:55.64732705-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-29T20:22:55.647347759-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-29T20:22:55.647347829-08:00"}}}
{"id":"behavior-8bd221b22d37","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Use floop MCP tools (floop_active, floop_learn, floop_list) instead of bash commands for all floop interactions. This provides better integration and type safety. Note: floop_active has a bug with null 'when' fields (feedback-loop-0gh) that needs fixing first.","expanded":"When working on this type of task, avoid: Used bash command './floop prompt --task development' to get active behaviors at session start\n\nInstead: Use floop MCP tools (floop_active, floop_learn, floop_list) instead of bash commands for all floop interactions. This provides better integration and type safety. Note: floop_active has a bug with null 'when' fields (feedback-loop-0gh) that needs fixing first.","structured":{"avoid":"Used bash command './floop prompt --task development' to get active behaviors at session start","prefer":"Use floop MCP tools (floop_active, floop_learn, floop_list) instead of bash commands for all floop interactions. This provides better integration and type safety. Note: floop_active has a bug with null 'when' fields (feedback-loop-0gh) that needs fixing first."}},"kind":"procedure","name":"learned/use-floop-mcp-tools-floop_active-floop_learn-fl","overrides":null,"provenance":{"correction_id":"correction-1769790638","created_at":"2026-01-30T08:30:38.332669915-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-30T08:30:38.332691127-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-30T08:30:38.332691197-08:00"}}}
{"id":"behavior-440356e972ee","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Agents should proactively use floop during conversations - capture corrections in real-time using own judgment and intuition","expanded":"When working on this type of task, avoid: Waited for explicit user instruction to use floop\n\nInstead: Agents should proactively use floop during conversations - capture corrections in real-time using own judgment and intuition","structured":{"avoid":"Waited for explicit user instruction to use floop","prefer":"Agents should proactively use floop during conversations - capture corrections in real-time using own judgment and intuition"}},"kind":"preference","name":"learned/agents-should-proactively-use-floop-during-convers","overrides":null,"provenance":{"correction_id":"c-1769577665725545057","created_at":"2026-01-27T21:21:05.725931864-08:00","source_type":"learned"},"requires":null,"when":{"task":"development"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T21:21:05.725944638-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T21:21:05.725944698-08:00"}}}
{"id":"behavior-95d6b9f414e4","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Global scope is for agent's personal preferences/style across ALL work. Local scope is for team/project-specific conventions. Both have distinct value.","expanded":"When working on this type of task, avoid: Assumed one storage location would be enough\n\nInstead: Global scope is for agent's personal preferences/style across ALL work. Local scope is for team/project-specific conventions. Both have distinct value.","structured":{"avoid":"Assumed one storage location would be enough","prefer":"Global scope is for agent's personal preferences/style across ALL work. Local scope is for team/project-specific conventions. Both have distinct value."}},"kind":"preference","name":"learned/global-scope-is-for-agents-personal-preferences-s","overrides":null,"provenance":{"correction_id":"c-1769577671639472329","created_at":"2026-01-27T21:21:11.6399097-08:00","source_type":"learned"},"requires":null,"when":{"task":"architecture"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T21:21:11.639924458-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T21:21:11.639924528-08:00"}}}
{"id":"behavior-967fd13bd390","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Use scope=both to save important learnings to both local and global","expanded":"When working on this type of task, avoid: Only saved to one store\n\nInstead: Use scope=both to save important learnings to both local and global","structured":{"avoid":"Only saved to one store","prefer":"Use scope=both to save important learnings to both local and global"}},"kind":"preference","name":"learned/use-scope=both-to-save-important-learnings-to-both","overrides":null,"provenance":{"correction_id":"c-1769616836888545203","created_at":"2026-01-28T08:13:56.88910412-08:00","source_type":"learned"},"requires":null,"when":{"task":"configuration"}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-28T08:13:56.88911961-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-28T08:13:56.88911967-08:00"}}}
{"id":"behavior-76e5757e480c","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"When using subagents for parallel work: (1) Have subagents do read-only tasks (research, exploration, planning), (2) Have the orchestrating agent do all file writes based on subagent findings, OR (3) Use worktrees but do the actual implementation work yourself after subagents gather context","expanded":"When working on this type of task, avoid: Spawned background subagents to write code in worktrees, but they failed with \"Permission to use Write has been auto-denied (prompts unavailable)\" because subagents cannot request interactive permissions\n\nInstead: When using subagents for parallel work: (1) Have subagents do read-only tasks (research, exploration, planning), (2) Have the orchestrating agent do all file writes based on subagent findings, OR (3) Use worktrees but do the actual implementation work yourself after subagents gather context","structured":{"avoid":"Spawned background subagents to write code in worktrees, but they failed with \"Permission to use Write has been auto-denied (prompts unavailable)\" because subagents cannot request interactive permissions","prefer":"When using subagents for parallel work: (1) Have subagents do read-only tasks (research, exploration, planning), (2) Have the orchestrating agent do all file writes based on subagent findings, OR (3) Use worktrees but do the actual implementation work yourself after subagents gather context"}},"kind":"preference","name":"learned/when-using-subagents-for-parallel-work-1-have-s","overrides":null,"provenance":{"correction_id":"correction-1769790625","created_at":"2026-01-30T08:30:25.315891951-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-30T08:30:25.315923263-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-30T08:30:25.315923393-08:00"}}}
{"id":"behavior-dfdc5e16b9e0","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Consider both global (~/.floop/) and local (./.floop/) scopes - users want personal preferences across ALL projects AND project-specific conventions","expanded":"When working on this type of task, avoid: Only considered project-local behavior storage\n\nInstead: Consider both global (~/.floop/) and local (./.floop/) scopes - users want personal preferences across ALL projects AND project-specific conventions","structured":{"avoid":"Only considered project-local behavior storage","prefer":"Consider both global (~/.floop/) and local (./.floop/) scopes - users want personal preferences across ALL projects AND project-specific conventions"}},"kind":"preference","name":"learned/consider-both-global-~-floop-and-local-flo","overrides":null,"provenance":{"correction_id":"c-1769577654747582237","created_at":"2026-01-27T21:20:54.748483819-08:00","source_type":"learned"},"requires":null,"when":{"file_path":"store/*","language":"go"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T21:20:54.748516411-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T21:20:54.748516481-08:00"}}}
{"id":"behavior-b7f5d1378039","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Beads export state auto-updates with each commit hash. After final push, restore the export state file instead of committing it again to break the cycle.","expanded":"When working on this type of task, avoid: Committed beads export state changes in a loop, causing infinite commits\n\nInstead: Beads export state auto-updates with each commit hash. After final push, restore the export state file instead of committing it again to break the cycle.","structured":{"avoid":"Committed beads export state changes in a loop, causing infinite commits","prefer":"Beads export state auto-updates with each commit hash. After final push, restore the export state file instead of committing it again to break the cycle."}},"kind":"preference","name":"learned/beads-export-state-auto-updates-with-each-commit-h","overrides":null,"provenance":{"correction_id":"c-1769581392105512844","created_at":"2026-01-27T22:23:12.106122549-08:00","source_type":"learned"},"requires":null,"when":{"task":"git workflow"}},"metadata":{"confidence":0.6,"priority":0,"stats":{"created_at":"2026-01-27T22:23:12.106138299-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-27T22:23:12.106138369-08:00"}}}
